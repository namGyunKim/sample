<!DOCTYPE html>
<html lang="ko"
      layout:decorate="~{layout/default}"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <title>회원 정보 수정</title>
</head>
<body>
<div class="max-w-2xl mx-auto py-8" layout:fragment="content">

    <div class="mb-8 text-center">
        <h2 class="text-3xl font-bold text-gray-900">회원 정보 수정</h2>
        <p class="mt-2 text-sm text-gray-600">개인 정보를 최신 상태로 관리하세요.</p>
    </div>

    <div class="bg-white shadow-lg rounded-lg border border-gray-100 overflow-hidden">
        <div class="p-8">
            <!-- Form Action에 targetId 포함 -->
            <form class="space-y-6" method="post"
                  th:action="@{/member/{role}/update/{id}(role=${role}, id=${targetId})}"
                  th:object="${memberUpdateRequest}"
                  hx-boost="false">

                <!-- 글로벌 에러 메시지 -->
                <div class="bg-red-50 border-l-4 border-red-500 p-4 mb-6" th:if="${#fields.hasGlobalErrors()}">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fa-solid fa-circle-exclamation text-red-500"></i>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-red-700" th:each="err : ${#fields.globalErrors()}" th:text="${err}"></p>
                        </div>
                    </div>
                </div>

                <!-- 로그인 아이디 (수정 불가) -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">로그인 아이디</label>
                    <div class="flex rounded-md shadow-sm">
                        <span class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm">
                            <i class="fa-solid fa-id-badge"></i>
                        </span>
                        <input class="flex-1 block w-full px-3 py-2 border border-gray-300 rounded-r-md bg-gray-100 text-gray-500 cursor-not-allowed focus:ring-0 focus:border-gray-300 sm:text-sm"
                               disabled type="text"
                               th:value="${currentMember.profile.loginId}">
                    </div>
                    <p class="mt-1 text-xs text-gray-500">아이디는 변경할 수 없습니다.</p>
                </div>

                <!-- 닉네임 -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1" for="nickName">닉네임</label>
                    <input class="block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                           id="nickName"
                           placeholder="사용하실 닉네임을 입력하세요"
                           th:field="*{nickName}"
                           th:classappend="${#fields.hasErrors('nickName')} ? 'border-red-300 focus:border-red-500 focus:ring-red-500' : ''"
                           type="text">
                    <p class="mt-1 text-xs text-red-600" th:errors="*{nickName}" th:if="${#fields.hasErrors('nickName')}"></p>
                </div>

                <div class="pt-4 flex items-center justify-end space-x-3 border-t border-gray-100 mt-6">
                    <!-- 취소 버튼: 본인이면 프로필로, 아니면 상세로 -->
                    <a class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
                       th:href="${#authentication.principal.id == targetId} ? @{/account/profile} : @{/member/{role}/detail/{id}(role=${role}, id=${targetId})}">
                        취소
                    </a>
                    <button class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
                            type="submit">
                        <i class="fa-solid fa-check mr-2 my-auto"></i>
                        수정 완료
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
</body>
</html>